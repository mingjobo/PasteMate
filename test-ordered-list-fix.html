<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>有序列表缩进修复验证</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; background: #f8f9fa; }
    .container { max-width: 900px; margin: 0 auto; background: white; padding: 25px; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
    .comparison { display: grid; grid-template-columns: 1fr 1fr; gap: 25px; margin: 25px 0; }
    .before, .after { border: 2px solid #ddd; padding: 20px; border-radius: 8px; }
    .before { background: #fff3f3; border-color: #ff6b6b; }
    .after { background: #f0fff4; border-color: #51cf66; }
    .test-result { background: #e3f2fd; border: 2px solid #2196f3; padding: 20px; border-radius: 8px; margin: 25px 0; }
    
    /* 修复前的样式（距离远） */
    .old-style ol { padding-left: 16px; font-size: 14px; }
    .old-style li { padding-left: 2px; font-size: 14px; }
    
    /* 修复后的样式（距离近） */
    .new-style ol { padding-left: 12px; font-size: 14px; }
    .new-style li { padding-left: 2px; font-size: 14px; }
    
    .highlight { background: #fff3cd; padding: 2px 4px; border-radius: 3px; }
  </style>
</head>
<body>
  <div class="container">
    <h1>🎯 有序列表缩进距离专项修复</h1>
    <p><strong>修复目标</strong>：<span class="highlight">大幅缩小数字与文字的距离</span></p>
    
    <div class="comparison">
      <div class="before old-style">
        <h4>🔴 修复前 (16px缩进)</h4>
        <h5>使用说明</h5>
        <ol>
          <li>若起始分数&lt;5.5，把每两周内容拉长到三周。</li>
          <li>若某科已≥7.0，可把对应时间让给弱项。</li>
          <li>每周日晚上固定 30 min 复盘，必要时微调下周计划。</li>
        </ol>
      </div>
      
      <div class="after new-style">
        <h4>🟢 修复后 (12px缩进)</h4>
        <h5>使用说明</h5>
        <ol>
          <li>若起始分数&lt;5.5，把每两周内容拉长到三周。</li>
          <li>若某科已≥7.0，可把对应时间让给弱项。</li>
          <li>每周日晚上固定 30 min 复盘，必要时微调下周计划。</li>
        </ol>
      </div>
    </div>

    <div class="test-result">
      <h4>🧪 WordOptimizer 处理结果</h4>
      <div id="optimizer-output" style="border: 1px solid #ccc; padding: 15px; background: white; min-height: 150px; border-radius: 4px;">
        正在生成处理结果...
      </div>
    </div>

    <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 8px; margin-top: 25px;">
      <h4>🔧 修复详情</h4>
      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 15px;">
        <div>
          <h5 style="margin: 0 0 10px 0; color: #ffd700;">有序列表优化</h5>
          <ul style="color: #f0f0f0; line-height: 1.6;">
            <li>一级列表: 16px → <strong style="color: #ffd700;">12px</strong> (-4px)</li>
            <li>二级嵌套: 28px → <strong style="color: #ffd700;">24px</strong> (-4px)</li>
            <li>三级嵌套: 40px → <strong style="color: #ffd700;">36px</strong> (-4px)</li>
          </ul>
        </div>
        <div>
          <h5 style="margin: 0 0 10px 0; color: #ffd700;">无序列表保持</h5>
          <ul style="color: #f0f0f0; line-height: 1.6;">
            <li>一级列表: <strong style="color: #90ee90;">16px</strong> (已优化)</li>
            <li>二级嵌套: <strong style="color: #90ee90;">28px</strong> (已优化)</li>
            <li>三级嵌套: <strong style="color: #90ee90;">40px</strong> (已优化)</li>
          </ul>
        </div>
      </div>
    </div>
  </div>

  <script type="module">
    import { WordOptimizer } from './src/WordOptimizer.js';

    async function testOrderedListOptimization() {
      try {
        const testHtml = `
          <h3>使用说明</h3>
          <ol>
            <li>若起始分数&lt;5.5，把每两周内容拉长到三周。</li>
            <li>若某科已≥7.0，可把对应时间让给弱项。</li>
            <li>每周日晚上固定 30 min 复盘，必要时微调下周计划。</li>
          </ol>
          <h3>每日时间灵活提示</h3>
          <ul>
            <li>通勤：听 BBC 6 Minute English 或剑桥 Section 1 音频。</li>
            <li>午休：Anki 刷 50 个单词/短语。</li>
            <li>工位：用耳机小声跟读口语 Part1，练语音语调。</li>
          </ul>
        `;

        console.log('=== 有序列表专项优化测试 ===');
        console.log('测试HTML:', testHtml);
        
        const optimizer = new WordOptimizer();
        const result = await optimizer.optimize(testHtml);
        
        console.log('处理结果长度:', result.length);
        console.log('处理结果预览:', result.substring(0, 800) + '...');

        // 显示结果
        document.getElementById('optimizer-output').innerHTML = result;
        
        // 验证关键修复点
        const hasOrderedListFix = result.includes('padding-left: 12px') && result.includes('list-style: decimal');
        const hasUnorderedListPreserved = result.includes('padding-left: 16px') && result.includes('list-style: disc');
        const hasFontSizeConsistency = (result.match(/font-size: 14px/g) || []).length >= 4;
        
        console.log('✅ 验证结果:');
        console.log('- 有序列表缩进修复:', hasOrderedListFix ? '✅ 通过 (12px)' : '❌ 失败');
        console.log('- 无序列表保持不变:', hasUnorderedListPreserved ? '✅ 通过 (16px)' : '❌ 失败');
        console.log('- 字体大小一致性:', hasFontSizeConsistency ? '✅ 通过' : '❌ 失败');
        
        // 添加验证结果到页面
        const validationDiv = document.createElement('div');
        validationDiv.style.cssText = 'background: #e8f5e8; border-left: 4px solid #4caf50; padding: 15px; margin-top: 15px; border-radius: 0 4px 4px 0;';
        validationDiv.innerHTML = `
          <h5 style="margin: 0 0 10px 0; color: #2e7d32;">🔍 自动验证结果</h5>
          <div style="line-height: 1.8;">
            <div>有序列表缩进修复: ${hasOrderedListFix ? '✅ 通过 (12px)' : '❌ 失败'}</div>
            <div>无序列表保持不变: ${hasUnorderedListPreserved ? '✅ 通过 (16px)' : '❌ 失败'}</div>
            <div>字体大小一致性: ${hasFontSizeConsistency ? '✅ 通过' : '❌ 失败'}</div>
          </div>
          <div style="margin-top: 10px; padding: 8px; background: #c8e6c9; border-radius: 3px; font-size: 13px;">
            <strong>总结:</strong> 有序列表数字与文字距离已显著缩短，现在比修复前更紧凑！
          </div>
        `;
        document.getElementById('optimizer-output').appendChild(validationDiv);

      } catch (error) {
        console.error('测试失败:', error);
        document.getElementById('optimizer-output').innerHTML = `
          <div style="color: #d32f2f; padding: 15px; background: #ffebee; border-radius: 4px; border-left: 4px solid #f44336;">
            <strong>❌ 测试失败:</strong> ${error.message}
            <br><small>请检查控制台获取详细错误信息</small>
          </div>
        `;
      }
    }

    // 页面加载后运行测试
    document.addEventListener('DOMContentLoaded', testOrderedListOptimization);
  </script>
</body>
</html>