<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kimi Wordå¯¼å‡ºåŠŸèƒ½æµ‹è¯•</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .test-container {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .kimi-content {
            background: #f8f9fa;
            border: 2px solid #007bff;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        .buttons {
            margin: 20px 0;
            text-align: center;
        }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            font-size: 16px;
            cursor: pointer;
            margin: 0 10px;
            transition: background-color 0.2s;
        }
        button:hover {
            background: #0056b3;
        }
        .test-info {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 15px;
            margin: 20px 0;
        }
        .table.markdown-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        .table.markdown-table th,
        .table.markdown-table td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        .table.markdown-table th {
            background-color: #f2f2f2;
            font-weight: bold;
        }
        .katex-container {
            margin: 15px 0;
        }
        .math-display {
            text-align: center;
            margin: 20px 0;
            font-size: 1.2em;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ğŸ§ª Kimi Wordå¯¼å‡ºåŠŸèƒ½æµ‹è¯•</h1>
        <div class="test-info">
            <strong>æµ‹è¯•è¯´æ˜ï¼š</strong>
            <br>1. ç‚¹å‡»"æµ‹è¯•Kimi Wordå¯¼å‡º"æŒ‰é’®æµ‹è¯•æ”¹è¿›åçš„åŠŸèƒ½
            <br>2. ç‚¹å‡»"æµ‹è¯•DeepSeek Wordå¯¼å‡º"æŒ‰é’®ç¡®ä¿å…¼å®¹æ€§
            <br>3. ä¸‹è½½çš„Wordæ–‡æ¡£åº”åŒ…å«æ‰€æœ‰æ ¼å¼ï¼šæ ‡é¢˜ã€åˆ—è¡¨ã€è¡¨æ ¼ã€æ•°å­¦å…¬å¼ã€ä»£ç ç­‰
        </div>

        <div class="buttons">
            <button onclick="testKimiWordExport()">ğŸ”¸ æµ‹è¯•Kimi Wordå¯¼å‡º</button>
            <button onclick="testDeepSeekWordExport()">ğŸ”¹ æµ‹è¯•DeepSeek Wordå¯¼å‡º</button>
        </div>

        <!-- Kimi æ ·å¼çš„æµ‹è¯•å†…å®¹ -->
        <div class="kimi-content segment-content-box">
            <div class="markdown-container">
                <div class="markdown">
                    <div class="paragraph">ä¸‹é¢è¿™æ®µæ–‡å­—ä¸€æ¬¡æ€§ç¤ºèŒƒäº† .docx é‡Œæ‰€æœ‰å¸¸è§æ ¼å¼ï¼Œä½ å¯ä»¥ç›´æ¥æŠŠå®ƒå¤åˆ¶åˆ° Word é‡Œï¼Œçœ‹å“ªäº›èƒ½é€šè¿‡"ç²˜è´´ä¿ç•™æºæ ¼å¼"è¢«è¯†åˆ«ï¼Œå“ªäº›éœ€è¦æ‰‹åŠ¨å†ç‚¹ä¸€ä¸‹æŒ‰é’®ã€‚</div>
                    <hr>
                    <h1>å®éªŒæŠ¥å‘Šï¼š2025 å¹´ 8 æœˆ 8 æ—¥</h1>
                    <h2>1 ç ”ç©¶èƒŒæ™¯</h2>
                    <div class="paragraph">æœ¬æŠ¥å‘Šæ—¨åœ¨éªŒè¯<strong>ç‰›é¡¿ç¬¬äºŒå®šå¾‹</strong> 
                        <span class="katex-container">
                            <span class="katex">
                                <annotation encoding="application/x-tex">F = ma</annotation>
                                F = ma
                            </span>
                        </span> åœ¨å°è½¦æ»‘è½¨å®éªŒä¸­çš„é€‚ç”¨æ€§ã€‚
                    </div>
                    <h3>1.1 å®éªŒå‡è®¾</h3>
                    <ul>
                        <li><div class="paragraph">å‡è®¾å°è½¦æ‰€å—å¤–åŠ›ä»…ç”±ç ç é‡åŠ›æä¾›ï¼›</div></li>
                        <li><div class="paragraph">å¿½ç•¥æ»‘è½®æ‘©æ“¦ä¸ç©ºæ°”é˜»åŠ›ã€‚</div></li>
                    </ul>
                    <div class="paragraph"><strong>æ³¨æ„</strong>ï¼šä»¥ä¸Šå‡è®¾åœ¨<em>çœŸå®åœºæ™¯</em>ä¸­å¹¶ä¸å®Œå…¨æˆç«‹ï¼Œå› æ­¤éœ€è¦è¯¯å·®åˆ†æã€‚</div>
                    
                    <h2>2 å®éªŒæ•°æ®</h2>
                    <div class="table markdown-table">
                        <table>
                            <thead>
                                <tr>
                                    <th>ç ç è´¨é‡ m / g</th>
                                    <th>åŠ é€Ÿåº¦ a / mÂ·sâ»Â²</th>
                                    <th>è®¡ç®—åŠ› F / N</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>50</td>
                                    <td>0.49</td>
                                    <td>0.245</td>
                                </tr>
                                <tr>
                                    <td>100</td>
                                    <td>0.98</td>
                                    <td>0.980</td>
                                </tr>
                                <tr>
                                    <td>150</td>
                                    <td>1.47</td>
                                    <td>1.470</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <h2>3 ç»“æœä¸è®¨è®º</h2>
                    <div class="paragraph">å¦‚å›¾ 1 æ‰€ç¤ºï¼Œå®éªŒæ•°æ®ä¸ç†è®ºå€¼ä¹‹é—´å‘ˆæ˜¾è‘—çº¿æ€§å…³ç³»ï¼ˆRÂ² = 0.999ï¼‰ã€‚</div>
                    <blockquote>
                        <div class="paragraph">å›¾ 1 ä½ç½®ï¼šæ­£æ–‡ä¸‹æ–¹ï¼Œè®¾ç½®ä¸º"åµŒå…¥å‹"ç¯ç»•ã€‚</div>
                    </blockquote>
                    
                    <h3>3.1 è¯¯å·®æ¥æº</h3>
                    <ol>
                        <li><div class="paragraph"><strong>æ»‘è½®æ‘©æ“¦</strong>ï¼šå¯¼è‡´æµ‹é‡åŠ é€Ÿåº¦åå°ï¼›</div></li>
                        <li><div class="paragraph"><em>ç©ºæ°”é˜»åŠ›</em>ï¼šéšé€Ÿåº¦å¢å¤§è€Œå¢åŠ ï¼›</div></li>
                        <li><div class="paragraph">è¯»æ•°è¯¯å·®ï¼šäººå·¥è®¡æ—¶ç²¾åº¦ Â±0.05 sã€‚</div></li>
                    </ol>

                    <h2>4 ç»“è®º</h2>
                    <div class="paragraph">ç»¼åˆä¸Šè¿°åˆ†æï¼Œå¯è®¤ä¸ºåœ¨å°è¯¯å·®èŒƒå›´å†…éªŒè¯äº†å…¬å¼</div>
                    <span class="katex-container math-display">
                        <span class="katex">
                            <annotation encoding="application/x-tex">\sum F = m \frac{d^2 x}{dt^2}</annotation>
                            âˆ‘F = m dÂ²x/dtÂ²
                        </span>
                    </span>
                    <div class="paragraph">çš„æ­£ç¡®æ€§ã€‚</div>
                    <hr>
                    
                    <h3>é™„ï¼šä»£ç ç¤ºä¾‹</h3>
                    <pre><code>def calculate_force(mass, acceleration):
    """è®¡ç®—ç‰›é¡¿ç¬¬äºŒå®šå¾‹ä¸­çš„åŠ›"""
    return mass * acceleration

# ç¤ºä¾‹è®¡ç®—
masses = [0.05, 0.1, 0.15]  # kg
accelerations = [0.49, 0.98, 1.47]  # m/sÂ²

for m, a in zip(masses, accelerations):
    force = calculate_force(m, a)
    print(f"è´¨é‡: {m} kg, åŠ é€Ÿåº¦: {a} m/sÂ², åŠ›: {force} N")</code></pre>

                    <div class="paragraph">è¡Œå†…ä»£ç ç¤ºä¾‹ï¼šä½¿ç”¨ <code>numpy.array()</code> è¿›è¡Œå‘é‡è®¡ç®—ã€‚</div>
                </div>
            </div>
        </div>

        <!-- DeepSeek æ ·å¼çš„æµ‹è¯•å†…å®¹ -->
        <div class="deepseek-content ds-markdown ds-markdown--block" style="margin-top: 40px; background: #f0f8ff; border: 2px solid #4CAF50; border-radius: 8px; padding: 20px;">
            <h2>DeepSeek æ ¼å¼æµ‹è¯•å†…å®¹</h2>
            <p class="ds-markdown-paragraph">è¿™æ˜¯ä¸€ä¸ª <strong>DeepSeek</strong> æ ¼å¼çš„æ®µè½ï¼ŒåŒ…å«<em>æ–œä½“</em>å’Œ<code>è¡Œå†…ä»£ç </code>ã€‚</p>
            <ul>
                <li>
                    <p class="ds-markdown-paragraph">DeepSeekåˆ—è¡¨é¡¹1</p>
                </li>
                <li>
                    <p class="ds-markdown-paragraph">DeepSeekåˆ—è¡¨é¡¹2</p>
                </li>
            </ul>
        </div>
    </div>

    <script type="module">
        // åŠ¨æ€å¯¼å…¥æ‰€éœ€æ¨¡å—
        async function loadModules() {
            const [
                { KimiHtmlFormatter },
                { DeepSeekHtmlFormatter },
                { exportToWord }
            ] = await Promise.all([
                import('../src/formatters/KimiHtmlFormatter.js'),
                import('../src/formatters/DeepSeekHtmlFormatter.js'),
                import('../src/export-to-word.js')
            ]);
            
            return { KimiHtmlFormatter, DeepSeekHtmlFormatter, exportToWord };
        }

        // æµ‹è¯•Kimi Wordå¯¼å‡ºåŠŸèƒ½
        window.testKimiWordExport = async function() {
            try {
                console.log('ğŸ§ª å¼€å§‹æµ‹è¯•Kimi Wordå¯¼å‡ºåŠŸèƒ½...');
                
                const { KimiHtmlFormatter, exportToWord } = await loadModules();
                
                // è·å–Kimiæ ¼å¼çš„æµ‹è¯•å†…å®¹
                const kimiContent = document.querySelector('.kimi-content');
                if (!kimiContent) {
                    throw new Error('æœªæ‰¾åˆ°Kimiæµ‹è¯•å†…å®¹');
                }
                
                console.log('ğŸ“„ æ‰¾åˆ°Kimiæµ‹è¯•å†…å®¹');
                
                // åˆå§‹åŒ–æ ¼å¼åŒ–å™¨
                const formatter = new KimiHtmlFormatter();
                
                // æ£€æŸ¥æ˜¯å¦å¯ä»¥å¤„ç†è¯¥å†…å®¹
                const canHandle = formatter.canHandle(kimiContent);
                console.log('ğŸ” æ ¼å¼åŒ–å™¨å¯ä»¥å¤„ç†è¯¥å†…å®¹:', canHandle);
                
                if (!canHandle) {
                    console.warn('âš ï¸ æ ¼å¼åŒ–å™¨æ— æ³•å¤„ç†è¯¥å†…å®¹ï¼Œä½¿ç”¨åŸå§‹HTML');
                }
                
                // æ ¼å¼åŒ–å†…å®¹
                const formattedHtml = await formatter.format(kimiContent);
                console.log('âœ… HTMLæ ¼å¼åŒ–å®Œæˆï¼Œé•¿åº¦:', formattedHtml.length);
                console.log('ğŸ“ æ ¼å¼åŒ–ç»“æœé¢„è§ˆ:', formattedHtml.substring(0, 500) + '...');
                
                // å¯¼å‡ºä¸ºWord
                await exportToWord(
                    formattedHtml, 
                    'Kimiæµ‹è¯•å¯¼å‡º.docx',
                    kimiContent,
                    'kimi'
                );
                
                alert('âœ… Kimi Wordå¯¼å‡ºæµ‹è¯•å®Œæˆï¼è¯·æ£€æŸ¥ä¸‹è½½çš„æ–‡æ¡£ã€‚');
                
            } catch (error) {
                console.error('âŒ Kimi Wordå¯¼å‡ºæµ‹è¯•å¤±è´¥:', error);
                alert('âŒ Kimi Wordå¯¼å‡ºæµ‹è¯•å¤±è´¥: ' + error.message);
            }
        };

        // æµ‹è¯•DeepSeek Wordå¯¼å‡ºåŠŸèƒ½
        window.testDeepSeekWordExport = async function() {
            try {
                console.log('ğŸ§ª å¼€å§‹æµ‹è¯•DeepSeek Wordå¯¼å‡ºåŠŸèƒ½...');
                
                const { DeepSeekHtmlFormatter, exportToWord } = await loadModules();
                
                // è·å–DeepSeekæ ¼å¼çš„æµ‹è¯•å†…å®¹
                const deepseekContent = document.querySelector('.deepseek-content');
                if (!deepseekContent) {
                    throw new Error('æœªæ‰¾åˆ°DeepSeekæµ‹è¯•å†…å®¹');
                }
                
                console.log('ğŸ“„ æ‰¾åˆ°DeepSeekæµ‹è¯•å†…å®¹');
                
                // åˆå§‹åŒ–æ ¼å¼åŒ–å™¨
                const formatter = new DeepSeekHtmlFormatter();
                
                // æ£€æŸ¥æ˜¯å¦å¯ä»¥å¤„ç†è¯¥å†…å®¹
                const canHandle = formatter.canHandle(deepseekContent);
                console.log('ğŸ” æ ¼å¼åŒ–å™¨å¯ä»¥å¤„ç†è¯¥å†…å®¹:', canHandle);
                
                if (!canHandle) {
                    console.warn('âš ï¸ æ ¼å¼åŒ–å™¨æ— æ³•å¤„ç†è¯¥å†…å®¹ï¼Œä½¿ç”¨åŸå§‹HTML');
                }
                
                // æ ¼å¼åŒ–å†…å®¹
                const formattedHtml = await formatter.format(deepseekContent);
                console.log('âœ… HTMLæ ¼å¼åŒ–å®Œæˆï¼Œé•¿åº¦:', formattedHtml.length);
                console.log('ğŸ“ æ ¼å¼åŒ–ç»“æœé¢„è§ˆ:', formattedHtml.substring(0, 500) + '...');
                
                // å¯¼å‡ºä¸ºWord
                await exportToWord(
                    formattedHtml, 
                    'DeepSeekæµ‹è¯•å¯¼å‡º.docx',
                    deepseekContent,
                    'deepseek'
                );
                
                alert('âœ… DeepSeek Wordå¯¼å‡ºæµ‹è¯•å®Œæˆï¼è¯·æ£€æŸ¥ä¸‹è½½çš„æ–‡æ¡£ã€‚');
                
            } catch (error) {
                console.error('âŒ DeepSeek Wordå¯¼å‡ºæµ‹è¯•å¤±è´¥:', error);
                alert('âŒ DeepSeek Wordå¯¼å‡ºæµ‹è¯•å¤±è´¥: ' + error.message);
            }
        };

        console.log('ğŸš€ æµ‹è¯•é¡µé¢åŠ è½½å®Œæˆ');
    </script>
</body>
</html>