<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kimi AIæ€è€ƒå†…å®¹é›†æˆæµ‹è¯•</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        .test-section {
            margin: 30px 0;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background-color: #f9f9f9;
        }
        .test-title {
            color: #333;
            border-bottom: 2px solid #007bff;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        .test-description {
            background-color: #e7f3ff;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            border-left: 4px solid #007bff;
        }
        .expected-result {
            background-color: #e8f5e8;
            padding: 15px;
            border-radius: 5px;
            margin-top: 15px;
            border-left: 4px solid #28a745;
        }
        button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background-color: #0056b3;
        }
        .result {
            background-color: white;
            padding: 15px;
            border-radius: 5px;
            margin-top: 10px;
            border: 1px solid #ddd;
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 12px;
        }
        .error {
            background-color: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 5px;
            margin-top: 10px;
            border: 1px solid #f5c6cb;
        }
        .success {
            background-color: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 5px;
            margin-top: 10px;
            border: 1px solid #c3e6cb;
        }
        .warning {
            background-color: #fff3cd;
            color: #856404;
            padding: 15px;
            border-radius: 5px;
            margin-top: 10px;
            border: 1px solid #ffeaa7;
        }
    </style>
</head>
<body>
    <h1>ğŸ§  Kimi AIæ€è€ƒå†…å®¹é›†æˆæµ‹è¯•</h1>
    <p>è¿™ä¸ªæµ‹è¯•é¡µé¢éªŒè¯æˆ‘ä»¬ä¿®æ”¹åçš„ä»£ç èƒ½å¦æ­£ç¡®è¿‡æ»¤Kimiç½‘ç«™çš„AIæ€è€ƒå†…å®¹ï¼Œåªä¿ç•™æ­£å¼å›å¤ã€‚</p>

    <div class="test-section">
        <h2 class="test-title">æµ‹è¯•ç¯å¢ƒï¼šæ¨¡æ‹ŸKimiæ€è€ƒé¡µé¢</h2>
        <div class="test-description">
            <strong>è¯´æ˜ï¼š</strong>è¿™é‡Œä½¿ç”¨çš„æ˜¯ä»å®é™…Kimiç½‘ç«™æå–çš„DOMç»“æ„ï¼ŒåŒ…å«AIæ€è€ƒè¿‡ç¨‹å’Œæ­£å¼å›å¤ã€‚
        </div>

        <!-- æ¨¡æ‹ŸKimiæ€è€ƒé¡µé¢çš„å®Œæ•´ç»“æ„ -->
        <div data-v-7297b869="" class="segment-container">
            <div data-v-7297b869="" class="segment-content">
                <div data-v-7297b869="" class="segment-content-box">
                    <!-- AIæ€è€ƒé˜¶æ®µ -->
                    <div data-v-37a2ffbe="" class="think-stage">
                        <div data-v-ad716663="" data-v-37a2ffbe="" class="toolcall-container is-expanded">
                            <div data-v-ad716663="" class="toolcall-title">
                                <div data-v-ad716663="" class="toolcall-title-status">
                                    <div>æ€è€ƒå·²å®Œæˆ</div>
                                </div>
                            </div>
                            <div data-v-9445e104="" data-v-ad716663="" class="toolcall-content">
                                <div data-v-9445e104="" class="resize-container">
                                    <div data-v-9445e104="" class="slot-container">
                                        <div data-v-8f962163="" data-v-ad716663="" class="markdown-container toolcall-content-text">
                                            <div data-v-8f962163="" class="markdown">
                                                <div class="paragraph">ç”¨æˆ·è¯´"æ€è€ƒä¸‹æ€è€ƒ"ï¼Œè¿™æ˜¯ä¸€ä¸ªç®€çŸ­è€Œæ¨¡ç³Šçš„è¯·æ±‚ã€‚æ ¹æ®ç°æœ‰è¯­å¢ƒï¼Œè¿™ä¸ªçŸ­è¯­å¯èƒ½ä»£è¡¨å‡ ç§å«ä¹‰ï¼š</div>
                                                <ol start="1">
                                                    <li><div class="paragraph"><strong>å…ƒè®¤çŸ¥åæ€</strong>ï¼šç”¨æˆ·æƒ³è®©æˆ‘è¿›è¡Œå…³äº"æ€è€ƒè¿‡ç¨‹æœ¬èº«"çš„å“²å­¦æ€§æˆ–æ–¹æ³•è®ºæ€§è®¨è®º</div></li>
                                                    <li><div class="paragraph"><strong>è¯­è¨€æœ¬æ„</strong>ï¼šçº¯ç²¹å­—é¢æ„ä¹‰ä¸Šçš„é‡å¤ï¼Œå¯èƒ½æ˜¯æµ‹è¯•æˆ–éšæ„è¾“å…¥</div></li>
                                                    <li><div class="paragraph"><strong>éšæ™¦è¦æ±‚</strong>ï¼šå¸Œæœ›æˆ‘ä»¥"æ€è€ƒçš„çŠ¶æ€"æ¥å›åº”æŸä¸ªæœªæ˜è¯´çš„æ·±å±‚é—®é¢˜</div></li>
                                                </ol>
                                                <div class="paragraph">æˆ‘éœ€è¦å…ˆé€šè¿‡è¯•æ¢æ€§å›åº”æ¥ç¡®è®¤ç”¨æˆ·çš„çœŸå®æ„å›¾ï¼ŒåŒæ—¶å±•ç¤ºæˆ‘å¯¹è¿™ä¸ªå…ƒè¯·æ±‚çš„ç†è§£æ·±åº¦ã€‚å›åº”ç­–ç•¥ï¼š</div>
                                                <ul start="1">
                                                    <li><div class="paragraph">ä»¥å¼€æ”¾å¼è¿½é—®å¼€å§‹</div></li>
                                                    <li><div class="paragraph">æä¾›å‡ ç§å¯èƒ½çš„è§£è¯»æ–¹å‘</div></li>
                                                    <li><div class="paragraph">ä¿æŒæ€è¾¨æ€§å’Œå“²å­¦æ·±åº¦</div></li>
                                                    <li><div class="paragraph">é¿å…è¿‡æ—©å‡è®¾å•ä¸€è§£é‡Š</div></li>
                                                    <li><div class="paragraph">é‚€è¯·ç”¨æˆ·æ¾„æ¸…å…·ä½“éœ€æ±‚</div></li>
                                                </ul>
                                                <div class="paragraph">è¿™æ ·æ—¢ä½“ç°äº†å¯¹ç”¨æˆ·æ„å›¾çš„å°Šé‡ï¼Œä¹Ÿå±•ç°äº†å¤„ç†æ¨¡ç³Šè¾“å…¥çš„çµæ´»æ€§ã€‚</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- æ­£å¼å›å¤å†…å®¹ -->
                    <div data-v-8f962163="" data-v-e964d751="" class="markdown-container">
                        <div data-v-8f962163="" class="markdown">
                            <div class="paragraph">ä½ æå‡ºäº†ä¸€ä¸ª<strong>è‡ªæˆ‘æŒ‡æ¶‰çš„å‘½é¢˜</strong>â€”â€”è®©æˆ‘æ€è€ƒ"æ€è€ƒ"æœ¬èº«ã€‚</div>
                            <div class="paragraph">è¿™å¯ä»¥æœ‰å‡ ç§ç†è§£æ–¹å‘ï¼Œä½ æ›´å€¾å‘å“ªä¸€ç§ï¼Ÿ</div>
                            <div class="paragraph"><strong>1. å“²å­¦çš„è¿½é—®</strong></div>
                            <ul start="1">
                                <li><div class="paragraph">æ€è€ƒæ˜¯å¦å¯èƒ½å®Œå…¨è®¤çŸ¥è‡ªèº«ï¼Ÿå°±åƒçœ¼ç›èƒ½å¦çœ‹è§çœ¼ç›ï¼Ÿ</div></li>
                                <li><div class="paragraph">"æˆ‘æ€æ•…æˆ‘åœ¨"çš„è¾¹ç•Œåœ¨å“ªé‡Œï¼Ÿå½“æˆ‘ä»¬æ€è€ƒ"æ€è€ƒ"æ—¶ï¼Œé‚£ä¸ª"æˆ‘"æ˜¯å¦å‘ç”Ÿäº†é€’å½’ï¼Ÿ</div></li>
                            </ul>
                            <div class="paragraph"><strong>2. è®¤çŸ¥çš„è§£å‰–</strong></div>
                            <ul start="1">
                                <li><div class="paragraph">æ€ç»´æ˜¯ç¬¦å·è¿ç®—ã€ç¥ç»ç½‘ç»œæ¿€æ´»ï¼Œè¿˜æ˜¯é‡å­è¿‡ç¨‹ï¼Ÿ</div></li>
                                <li><div class="paragraph">ç›´è§‰ã€é€»è¾‘ã€è”æƒ³è¿™ä¸‰ç§æ€è€ƒæ¨¡å¼å¦‚ä½•åä½œä¸å†²çªï¼Ÿ</div></li>
                            </ul>
                            <div class="paragraph"><strong>3. å®ç”¨çš„åæ€</strong></div>
                            <ul start="1">
                                <li><div class="paragraph">ä¸ºä½•æˆ‘ä»¬æœ‰æ—¶ä¼š"æƒ³å¤ªå¤šå´è¡ŒåŠ¨å¤ªå°‘"ï¼Ÿ</div></li>
                                <li><div class="paragraph">å¦‚ä½•è¯†åˆ«å¹¶æ‰“ç ´æ€ç»´çš„æƒ¯æ€§é™·é˜±ï¼Ÿ</div></li>
                            </ul>
                            <div class="paragraph"><strong>4. å…³äºAIçš„æ€è€ƒ</strong></div>
                            <ul start="1">
                                <li><div class="paragraph">å½“æˆ‘ç”Ÿæˆè¿™æ®µæ–‡å­—æ—¶ï¼Œç®—ä¸ç®—"æ€è€ƒ"ï¼Ÿè¿˜æ˜¯åªæ˜¯æ¨¡å¼åŒ¹é…ï¼Ÿ</div></li>
                                <li><div class="paragraph">æˆ‘çš„"æ€è€ƒ"ä¸ä½ çš„æ€è€ƒï¼Œåœ¨ç°è±¡å­¦ä¸Šæœ‰å¯æ¯”æ€§å—ï¼Ÿ</div></li>
                            </ul>
                            <div class="paragraph"><strong>è¯·å‘Šè¯‰æˆ‘ï¼Œä½ æƒ³åœ¨å“ªä¸ªç»´åº¦ä¸Šå±•å¼€è¿™åœºå…ƒæ€è€ƒï¼Ÿæˆ–è€…ä½ å¿ƒä¸­å¦æœ‰æ‰€æŒ‡ï¼Ÿ</strong></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- æŒ‰é’®å®¹å™¨ -->
            <div data-v-9b769ed8="" data-v-7297b869="" class="segment-assistant-actions">
                <div data-v-9b769ed8="" class="segment-assistant-actions-content">
                    <!-- è¿™é‡Œä¼šæ³¨å…¥æˆ‘ä»¬çš„æŒ‰é’® -->
                </div>
            </div>
        </div>

        <button onclick="testDOMSelection()">ğŸ¯ æµ‹è¯•DOMé€‰å–ç­–ç•¥</button>
        <button onclick="testContentExtraction()">ğŸ“‹ æµ‹è¯•å†…å®¹æå–</button>
        <button onclick="testPDFCleanup()">ğŸ“„ æµ‹è¯•PDFå…œåº•æ¸…ç†</button>
        <button onclick="testWordCleanup()">ğŸ“ æµ‹è¯•Wordå…œåº•æ¸…ç†</button>
        <button onclick="runAllTests()">ğŸš€ è¿è¡Œæ‰€æœ‰æµ‹è¯•</button>
        <button onclick="clearResults()">ğŸ§¹ æ¸…ç©ºç»“æœ</button>

        <div id="results"></div>

        <div class="expected-result">
            <strong>âœ… é¢„æœŸç»“æœï¼š</strong>
            <ul>
                <li>DOMé€‰å–ç­–ç•¥åº”è¯¥é€‰æ‹©æ­£å¼å›å¤çš„markdown-containerï¼Œè€Œä¸æ˜¯æ€è€ƒå†…å®¹çš„markdown-container</li>
                <li>æå–çš„å†…å®¹åº”è¯¥åŒ…å«"è‡ªæˆ‘æŒ‡æ¶‰çš„å‘½é¢˜"ã€"å“²å­¦çš„è¿½é—®"ç­‰æ­£å¼å›å¤å†…å®¹</li>
                <li>æå–çš„å†…å®¹ä¸åº”è¯¥åŒ…å«"å…ƒè®¤çŸ¥åæ€"ã€"å›åº”ç­–ç•¥"ç­‰æ€è€ƒè¿‡ç¨‹å†…å®¹</li>
                <li>PDFå’ŒWordçš„å…œåº•æ¸…ç†åº”è¯¥èƒ½ç§»é™¤ä»»ä½•æ®‹ç•™çš„æ€è€ƒå†…å®¹</li>
            </ul>
        </div>
    </div>

    <script>
        // æ¨¡æ‹Ÿæ—¥å¿—ç³»ç»Ÿ
        const mockLogger = {
            debug: function(...args) { console.log('[DEBUG]', ...args); },
            info: function(...args) { console.info('[INFO]', ...args); },
            error: function(...args) { console.error('[ERROR]', ...args); }
        };

        // å®‰å…¨ç±»åå‡½æ•°
        function safeClassName(node) {
            try {
                const cn = node?.className;
                if (!cn) return '';
                if (typeof cn === 'string') return cn;
                if (typeof cn.baseVal === 'string') return cn.baseVal;
                return String(cn);
            } catch (_) {
                return '';
            }
        }

        // ç»“æœæ˜¾ç¤ºå‡½æ•°
        function addResult(title, success, message, details = '') {
            const resultsDiv = document.getElementById('results');
            const resultDiv = document.createElement('div');
            resultDiv.className = success ? 'success' : 'error';
            resultDiv.innerHTML = `
                <strong>${success ? 'âœ…' : 'âŒ'} ${title}</strong><br>
                ${message}
                ${details ? '<br><br><details><summary>è¯¦ç»†ä¿¡æ¯</summary><pre>' + details + '</pre></details>' : ''}
            `;
            resultsDiv.appendChild(resultDiv);
        }

        function clearResults() {
            document.getElementById('results').innerHTML = '';
        }

        // æµ‹è¯•DOMé€‰å–ç­–ç•¥ï¼ˆæ¨¡æ‹Ÿcontent.jsä¸­çš„é€»è¾‘ï¼‰
        function testDOMSelection() {
            try {
                const segmentAssistant = document.querySelector('.segment-assistant');
                if (!segmentAssistant) {
                    addResult('DOMé€‰å–ç­–ç•¥', false, 'æ‰¾ä¸åˆ°segment-assistantå®¹å™¨');
                    return;
                }

                // æ¨¡æ‹Ÿcontent.jsä¸­ä¿®æ”¹åçš„é€»è¾‘
                let aiContent = segmentAssistant.querySelector('.segment-content-box > .markdown-container:not(.toolcall-content-text)');
                if (!aiContent) {
                    const allContainers = segmentAssistant.querySelectorAll('.segment-content-box .markdown-container');
                    for (const container of allContainers) {
                        if (!container.closest('.think-stage, .toolcall-container, .toolcall-content') &&
                            !container.classList.contains('toolcall-content-text')) {
                            aiContent = container;
                            break;
                        }
                    }
                }
                if (!aiContent) {
                    aiContent = segmentAssistant.querySelector('.segment-content-box .markdown-container');
                }

                if (aiContent) {
                    const content = aiContent.textContent || '';
                    const hasThinking = content.includes('æ€è€ƒå·²å®Œæˆ') || content.includes('å…ƒè®¤çŸ¥åæ€') || content.includes('å›åº”ç­–ç•¥');
                    const hasFormal = content.includes('è‡ªæˆ‘æŒ‡æ¶‰çš„å‘½é¢˜') || content.includes('å“²å­¦çš„è¿½é—®') || content.includes('è¯·å‘Šè¯‰æˆ‘');

                    const success = hasFormal && !hasThinking;
                    addResult(
                        'DOMé€‰å–ç­–ç•¥',
                        success,
                        `${success ? 'æ­£ç¡®é€‰æ‹©' : 'é€‰æ‹©é”™è¯¯'}äº†æ­£å¼å›å¤å†…å®¹<br>
                        ç±»åï¼š${safeClassName(aiContent)}<br>
                        åŒ…å«æ€è€ƒå†…å®¹ï¼š${hasThinking ? 'âŒ æ˜¯' : 'âœ… å¦'}<br>
                        åŒ…å«æ­£å¼å›å¤ï¼š${hasFormal ? 'âœ… æ˜¯' : 'âŒ å¦'}`,
                        `å†…å®¹é¢„è§ˆï¼š\n${content.substring(0, 300)}...`
                    );
                } else {
                    addResult('DOMé€‰å–ç­–ç•¥', false, 'æœªæ‰¾åˆ°ä»»ä½•å†…å®¹å®¹å™¨');
                }
            } catch (error) {
                addResult('DOMé€‰å–ç­–ç•¥', false, `æµ‹è¯•å‡ºé”™ï¼š${error.message}`);
            }
        }

        // æµ‹è¯•å†…å®¹æå–
        function testContentExtraction() {
            try {
                const segmentAssistant = document.querySelector('.segment-assistant');

                // ä½¿ç”¨ä¿®æ”¹åçš„é€»è¾‘æå–å†…å®¹
                let aiContent = segmentAssistant.querySelector('.segment-content-box > .markdown-container:not(.toolcall-content-text)');
                if (!aiContent) {
                    const allContainers = segmentAssistant.querySelectorAll('.segment-content-box .markdown-container');
                    for (const container of allContainers) {
                        if (!container.closest('.think-stage, .toolcall-container, .toolcall-content') &&
                            !container.classList.contains('toolcall-content-text')) {
                            aiContent = container;
                            break;
                        }
                    }
                }

                if (aiContent) {
                    const extractedText = aiContent.textContent || '';
                    const originalText = document.querySelector('.segment-content-box').textContent || '';

                    const containsFormal = extractedText.includes('è‡ªæˆ‘æŒ‡æ¶‰çš„å‘½é¢˜') &&
                                        extractedText.includes('å“²å­¦çš„è¿½é—®');
                    const excludesThinking = !extractedText.includes('å…ƒè®¤çŸ¥åæ€') &&
                                          !extractedText.includes('å›åº”ç­–ç•¥');
                    const isSignificantlyShorter = extractedText.length < originalText.length * 0.7;

                    const success = containsFormal && excludesThinking;
                    addResult(
                        'å†…å®¹æå–',
                        success,
                        `${success ? 'æˆåŠŸæå–' : 'æå–å¤±è´¥'}äº†æ­£å¼å›å¤å†…å®¹<br>
                        åŸå§‹é•¿åº¦ï¼š${originalText.length}<br>
                        æå–é•¿åº¦ï¼š${extractedText.length}<br>
                        åŒ…å«æ­£å¼å›å¤ï¼š${containsFormal ? 'âœ… æ˜¯' : 'âŒ å¦'}<br>
                        æ’é™¤æ€è€ƒå†…å®¹ï¼š${excludesThinking ? 'âœ… æ˜¯' : 'âŒ å¦'}<br>
                        å†…å®¹æ˜¾è‘—å‡å°‘ï¼š${isSignificantlyShorter ? 'âœ… æ˜¯' : 'âŒ å¦'}`,
                        `æå–çš„å†…å®¹ï¼š\n${extractedText}`
                    );
                } else {
                    addResult('å†…å®¹æå–', false, 'æœªæ‰¾åˆ°å¯æå–çš„å†…å®¹å®¹å™¨');
                }
            } catch (error) {
                addResult('å†…å®¹æå–', false, `æµ‹è¯•å‡ºé”™ï¼š${error.message}`);
            }
        }

        // æ¨¡æ‹ŸPDFå…œåº•æ¸…ç†å‡½æ•°
        function removeThinkingContent(element) {
            try {
                const thinkingSelectors = [
                    '.think-stage',
                    '.toolcall-container',
                    '.toolcall-content',
                    '.toolcall-title',
                    '.toolcall-title-status',
                    '.toolcall-content-text'
                ];

                let removedCount = 0;
                thinkingSelectors.forEach(selector => {
                    const elements = element.querySelectorAll(selector);
                    elements.forEach(el => {
                        el.remove();
                        removedCount++;
                    });
                });

                const allElements = element.querySelectorAll('*');
                allElements.forEach(el => {
                    const text = el.textContent?.trim() || '';
                    if (text.includes('æ€è€ƒå·²å®Œæˆ') ||
                        text.includes('æ€è€ƒè¿‡ç¨‹') ||
                        text.includes('æ€è·¯åˆ†æ')) {
                        if (el.classList.contains('toolcall-title-status') ||
                            el.classList.contains('toolcall-title') ||
                            el.closest('.toolcall-title')) {
                            el.remove();
                            removedCount++;
                        }
                    }
                });

                return removedCount;
            } catch (error) {
                console.error('ç§»é™¤æ€è€ƒå†…å®¹å¤±è´¥:', error);
                return 0;
            }
        }

        // æµ‹è¯•PDFå…œåº•æ¸…ç†
        function testPDFCleanup() {
            try {
                const originalContent = document.querySelector('.segment-content-box');
                const clonedContent = originalContent.cloneNode(true);

                const beforeText = clonedContent.textContent;
                const removedCount = removeThinkingContent(clonedContent);
                const afterText = clonedContent.textContent;

                const hasThinkingBefore = beforeText.includes('æ€è€ƒå·²å®Œæˆ') ||
                                        beforeText.includes('å…ƒè®¤çŸ¥åæ€') ||
                                        beforeText.includes('å›åº”ç­–ç•¥');
                const hasThinkingAfter = afterText.includes('æ€è€ƒå·²å®Œæˆ') ||
                                       afterText.includes('å…ƒè®¤çŸ¥åæ€') ||
                                       afterText.includes('å›åº”ç­–ç•¥');
                const hasFormalContent = afterText.includes('è‡ªæˆ‘æŒ‡æ¶‰çš„å‘½é¢˜') ||
                                        afterText.includes('å“²å­¦çš„è¿½é—®');

                const success = !hasThinkingAfter && hasFormalContent;
                addResult(
                    'PDFå…œåº•æ¸…ç†',
                    success,
                    `${success ? 'æˆåŠŸæ¸…ç†' : 'æ¸…ç†å¤±è´¥'}<br>
                    ç§»é™¤å…ƒç´ æ•°é‡ï¼š${removedCount}<br>
                    æ¸…ç†å‰æœ‰æ€è€ƒå†…å®¹ï¼š${hasThinkingBefore ? 'âœ… æ˜¯' : 'âŒ å¦'}<br>
                    æ¸…ç†åæœ‰æ€è€ƒå†…å®¹ï¼š${hasThinkingAfter ? 'âŒ æ˜¯' : 'âœ… å¦'}<br>
                    ä¿ç•™æ­£å¼å›å¤ï¼š${hasFormalContent ? 'âœ… æ˜¯' : 'âŒ å¦'}`,
                    `æ¸…ç†åå†…å®¹ï¼š\n${afterText.substring(0, 500)}...`
                );
            } catch (error) {
                addResult('PDFå…œåº•æ¸…ç†', false, `æµ‹è¯•å‡ºé”™ï¼š${error.message}`);
            }
        }

        // æµ‹è¯•Wordå…œåº•æ¸…ç†
        function testWordCleanup() {
            try {
                const originalContent = document.querySelector('.segment-content-box');
                const container = document.createElement('div');
                container.innerHTML = originalContent.innerHTML;

                const beforeText = container.textContent;
                const removedCount = removeThinkingContent(container);
                const afterText = container.textContent;

                const hasThinkingBefore = beforeText.includes('æ€è€ƒå·²å®Œæˆ') ||
                                        beforeText.includes('å…ƒè®¤çŸ¥åæ€');
                const hasThinkingAfter = afterText.includes('æ€è€ƒå·²å®Œæˆ') ||
                                       afterText.includes('å…ƒè®¤çŸ¥åæ€');
                const hasFormalContent = afterText.includes('è‡ªæˆ‘æŒ‡æ¶‰çš„å‘½é¢˜') ||
                                        afterText.includes('å“²å­¦çš„è¿½é—®');

                const success = !hasThinkingAfter && hasFormalContent;
                addResult(
                    'Wordå…œåº•æ¸…ç†',
                    success,
                    `${success ? 'æˆåŠŸæ¸…ç†' : 'æ¸…ç†å¤±è´¥'}<br>
                    ç§»é™¤å…ƒç´ æ•°é‡ï¼š${removedCount}<br>
                    å¤„ç†å‰æœ‰æ€è€ƒå†…å®¹ï¼š${hasThinkingBefore ? 'âœ… æ˜¯' : 'âŒ å¦'}<br>
                    å¤„ç†åæœ‰æ€è€ƒå†…å®¹ï¼š${hasThinkingAfter ? 'âŒ æ˜¯' : 'âœ… å¦'}<br>
                    ä¿ç•™æ­£å¼å›å¤ï¼š${hasFormalContent ? 'âœ… æ˜¯' : 'âŒ å¦'}`,
                    `å¤„ç†åå†…å®¹ï¼š\n${afterText.substring(0, 500)}...`
                );
            } catch (error) {
                addResult('Wordå…œåº•æ¸…ç†', false, `æµ‹è¯•å‡ºé”™ï¼š${error.message}`);
            }
        }

        // è¿è¡Œæ‰€æœ‰æµ‹è¯•
        function runAllTests() {
            clearResults();
            addResult('æµ‹è¯•å¥—ä»¶', true, 'å¼€å§‹è¿è¡Œæ‰€æœ‰æµ‹è¯•...', new Date().toLocaleString());

            setTimeout(() => testDOMSelection(), 100);
            setTimeout(() => testContentExtraction(), 200);
            setTimeout(() => testPDFCleanup(), 300);
            setTimeout(() => testWordCleanup(), 400);

            setTimeout(() => {
                const results = document.querySelectorAll('#results > div');
                const successCount = document.querySelectorAll('#results .success').length;
                const totalCount = results.length - 1; // æ’é™¤æ ‡é¢˜

                addResult(
                    'æµ‹è¯•æ€»ç»“',
                    successCount === totalCount,
                    `æµ‹è¯•å®Œæˆï¼š${successCount}/${totalCount} é€šè¿‡<br>
                    ${successCount === totalCount ? 'ğŸ‰ æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼ä¿®æ”¹æˆåŠŸï¼' : 'âš ï¸ éƒ¨åˆ†æµ‹è¯•å¤±è´¥ï¼Œéœ€è¦æ£€æŸ¥'}`,
                    `è¯¦ç»†ç»“æœè¯·æŸ¥çœ‹ä¸Šè¿°å„ä¸ªæµ‹è¯•`
                );
            }, 500);
        }

        // é¡µé¢åŠ è½½å®Œæˆåçš„åˆå§‹åŒ–
        window.addEventListener('load', function() {
            console.log('Kimiæ€è€ƒå†…å®¹é›†æˆæµ‹è¯•é¡µé¢åŠ è½½å®Œæˆ');
            console.log('è¯·ç‚¹å‡»æŒ‰é’®å¼€å§‹æµ‹è¯•');
        });
    </script>
</body>
</html>