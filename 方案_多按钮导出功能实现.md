# PureText 多按钮导出功能架构方案

## 一、按钮组件设计

### 1. 继承 BaseActionButton
- 新建 DownloadWordButton 和 DownloadPdfButton，均继承自 BaseActionButton。
- 支持传入 icon 或纯文字，样式、交互与 CopyButton 保持一致。

### 2. 目录结构建议
src/
  - DownloadWordButton.js
  - DownloadPdfButton.js

---

## 二、按钮注入机制

### 1. 注入逻辑
- 参考 content.js 里 ButtonInjector 的 scanAndInjectButtons、injectButtonToKimiActions、injectButton 方法。
- 新按钮的注入点、顺序、容器与“复制到Word”按钮完全一致，保证三个按钮并排出现。

### 2. Kimi/DeepSeek 特殊处理
- Kimi：在 .segment-assistant-actions-content 容器内，appendChild 到“复制到Word”按钮后面。
- DeepSeek：在 ds-icon-button 父容器内，insertAfter 到“复制到Word”按钮后面。

---

## 三、功能实现建议

### 1. 下载为 Word
- 新建 src/export-to-word.js，封装导出逻辑（可用 docx.js 或 html-docx-js）。
- 按钮点击时，获取当前 AI 回复内容，格式化后生成 docx Blob，自动下载。

### 2. 下载为 PDF
- 新建 src/export-to-pdf.js，封装导出逻辑（可用 jsPDF 或 html2pdf.js）。
- 按钮点击时，获取当前 AI 回复内容，格式化后生成 pdf Blob，自动下载。

---

## 四、关键实现点

### 1. 新按钮组件（伪代码）
```js
// src/DownloadWordButton.js
import { BaseActionButton } from './BaseActionButton.js';
class DownloadWordButton extends BaseActionButton {
  static create(targetElement, onDownload) {
    const buttonText = '下载为 Word';
    // ...同CopyButton，支持icon
    return super.createBaseButton(buttonText, onDownload, { targetElement });
  }
}
export { DownloadWordButton };
```
PDF 按钮同理。

### 2. 注入到网页
- 在 content.js 的 ButtonInjector.createButtonForKimiActions 和 createButton 方法中，创建 CopyButton 后，紧接着创建 DownloadWordButton、DownloadPdfButton，并 append/insertAfter 到同一容器。
- 保证按钮组顺序为：复制到Word | 下载为Word | 下载为PDF

### 3. 事件处理
- onDownloadWord、onDownloadPdf 事件中，获取 AI 回复内容，调用对应导出工具函数。

---

## 五、伪代码流程（Kimi为例）

```js
// content.js 片段
const copyBtn = CopyButton.create(...);
const wordBtn = DownloadWordButton.create(..., onDownloadWord);
const pdfBtn = DownloadPdfButton.create(..., onDownloadPdf);
actionContainer.appendChild(copyBtn);
actionContainer.appendChild(wordBtn);
actionContainer.appendChild(pdfBtn);
```
DeepSeek 逻辑同理，只是插入点不同。

---

## 六、总结

- 新按钮继承 BaseActionButton，风格统一。
- 注入机制完全复用 CopyButton 现有架构，Kimi/DeepSeek 分别处理。
- 事件处理独立，便于维护和扩展。
- 代码结构清晰，易于后续增加更多导出格式。

---

如需详细代码实现或有特殊交互需求，请补充说明。
你还需要导出功能的具体技术选型建议或代码示例吗？ 

# Task
【】新建 DownloadWordButton 和 DownloadPdfButton，继承 BaseActionButton，实现 create 方法，支持 icon/文字。
【】在 content.js 的 ButtonInjector 中，注入新按钮到 Kimi/DeepSeek/通用网站，保证与 CopyButton 并排。
【】实现导出为 Word 的工具函数（src/export-to-word.js），支持 HTML/纯文本转 docx 并下载。
【】实现导出为 PDF 的工具函数（src/export-to-pdf.js），支持 HTML/纯文本转 pdf 并下载。
【】在按钮点击事件中，获取 AI 回复内容，调用导出工具函数，完成下载。
【】保证按钮样式、交互、国际化与 CopyButton 一致，支持 icon/文字切换。